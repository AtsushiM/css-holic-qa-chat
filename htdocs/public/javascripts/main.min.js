var cssholicqachat={};cssholicqachat.socket=io.connect(),cssholicqachat.addQuestion=function(t){cssholicqachat.collections.questions.add(new cssholicqachat.models.Question({defaults:t}))},cssholicqachat._dayConvertAry=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],cssholicqachat._formatNumDigit2=function(t){return t=1*t,10>t&&(t="0"+t),""+t},cssholicqachat.formatDate=function(t){var e=cssholicqachat._formatNumDigit2,s=[t.getFullYear(),e(t.getMonth()),e(t.getDate())],i=[e(t.getHours()),e(t.getMinutes()),e(t.getSeconds())];return s.join("/")+"("+cssholicqachat._dayConvertAry[t.getDay()]+")"+" "+i.join(":")},cssholicqachat.collections={questions:new C.Collection},cssholicqachat.models={Question:C.Model.extend({defaults:{name:"",q:"",time:0},validate:{name:C.validate.isString,q:C.validate.isString,time:C.validate.isNumber}})},cssholicqachat.views={sendBlock:new C.View({el:"#send",init:function(){this.username=this.el.find(".username input"),this.question=this.el.find(".question input"),this.lock()},events:{me:{submit:"submit"}},lock:function(){this.el.css({opacity:"0.5"}),this.isLock=!0},unlock:function(){this.el.css({opacity:"1"}),this.isLock=!1},submit:function(t){t.preventDefault();var e=this.username.val()||"No name",s=this.question.val();!this.isLock&&s&&(cssholicqachat.socket.emit("sendquestion",{name:e,q:s}),this.question.val(""),this.lock())}}),questions:new C.View({el:"#questions",template:C.$("#template-question").html(),collection:cssholicqachat.collections.questions,init:function(){var t=this;t.collection.on("change",t.render),cssholicqachat.socket.on("recivequestion",function(t){cssholicqachat.addQuestion(t),cssholicqachat.views.sendBlock.unlock()})},events:{},clear:function(){this.el.html("")},render:function(t){t=t.get(),t.time=cssholicqachat.formatDate(new Date(t.time));var e=C.util.template(this.template,t),s=C.dom.create("li");C.dom.html(s,e),this.el.insertBefore(s)}})},cssholicqachat.socket.on("initializequestion",function(t){var e=0,s=t.length;for(cssholicqachat.views.questions.clear();s>e;e++)cssholicqachat.addQuestion(t[e]);cssholicqachat.views.sendBlock.unlock()}),function(){var t,e,s=C.$("h1"),i=s.html().replace("&amp;","&");for(s.html("<span>"+i.split("").join("</span><span>")+"</span>"),t=s.find("span"),e=t.length;e--;)C.dom.addClass(t[e],"letter"+e)}();